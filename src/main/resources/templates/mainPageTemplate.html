<!DOCTYPE html>
<html lang="en">
<head th:insert="~{fragmentExample/fragments/bootstrap.html}">
    <title>Gardens</title>
</head>
<body>

<div th:insert="~{fragmentExample/fragments/navbar.html}"></div>

<div class="container">
    <div class="row" id='widget-container'>
        <!-- Recently accessed gardens and Newest Plants -->
        <div class="col d-flex flex-column justify-content-between" id='widget-box'>
            <div class="row" id="widget-small-boxes">
                <!-- Recently accessed gardens -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">Recently accessed gardens</div>
                        <ul class="list-group">
                            <li th:each="garden : ${recentGardens}" class="list-group-item p-0">
                                <a th:href="@{/gardens/details(gardenId=${garden.id})}" class="d-block p-3 text-decoration-none text-dark">
                                    <span th:text="${garden.name}">Garden Name</span> <br>
                                    <small th:text="${garden.location}">Location</small>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- Newest Plants -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-title">Newest Plants</div>
                        <ul class="list-group">
                            <li class="list-group-item"><img src="plant-icon.png" alt="Plant Icon"> Sapling <br><small>Fabian’s Garden</small></li>
                            <li class="list-group-item"><img src="plant-icon.png" alt="Plant Icon"> Rose <br><small>Fabian’s Garden</small></li>
                            <li class="list-group-item"><img src="plant-icon.png" alt="Plant Icon"> Plant <br><small>Fabian’s Garden</small></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="row">
                <!-- My Friend's List -->
                <div class="col-md-12" id="widget-wide">
                    <div class="card">
                        <div class="card-title">My Friend’s List</div>
                        <div class="d-flex flex-wrap" style="height: 134px;">
                            <div class="p-2 flex-fill text-center">
                                <img src="friend-icon.png" alt="Friend Icon"><br>
                                Jasmine Ong
                            </div>
                            <div class="p-2 flex-fill text-center">
                                <img src="friend-icon.png" alt="Friend Icon"><br>
                                Arthur Bell
                            </div>
                            <div class="p-2 flex-fill text-center">
                                <img src="friend-icon.png" alt="Friend Icon"><br>
                                Isaac Steele
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- My Garden's List -->
        <div class="col-md-4" id='widget-tall' >
            <div class="card mt-0">
                <div class="card-title">My Garden’s List</div>
                <div class="list-group" style="overflow-y: scroll; height: 460px;">
                    <p th:class="${gardens.isEmpty()}? 'alert alert-secondary' : 'd-none'"> No gardens created </p>
                    <th:block th:each="garden : ${gardens}">
                        <a class="list-group-item" th:href="@{/gardens/details(gardenId=${garden.id})}">
                            <p th:text="${garden.name}"></p>
                            <small th:text="${garden.location}" ></small>
                        </a>
                    </th:block>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
    /*<![CDATA[*/
    // Thymeleaf variable injected into JavaScript
    const ordering = /*[[${ordering}]]*/ 'default';
    console.log(ordering);
    /*]]>*/

    function orderItems(ordering) {

        const order = ordering.split(' ');
        console.log(order);
        let container = document.getElementById('widget-container');
        let box = document.getElementById('widget-box');
        const tall = document.getElementById('widget-tall');
        const wide = document.getElementById('widget-wide');
        const smallBoxes = document.getElementById('widget-small-boxes')

        container.innerHTML = '';
        // if the 4th widget (the tall one) is first, move it to the left, otherwise leave it
        if (order[0] === '3') {
            container.appendChild(tall);
            container.appendChild(box);
        } else {
            container.appendChild(box);
            container.appendChild(tall);
        }

        // if the 3rd widget (the wide one) comes before the two boxes, move it above
        if (order.indexOf('2') < order.indexOf('1')) {
            box.appendChild(wide);
            box.appendChild(smallBoxes);
        } else {
            box.appendChild(smallBoxes);
            box.appendChild(wide);
        }
    }
    orderItems(ordering);
</script>
</body>
</html>
