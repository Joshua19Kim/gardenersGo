<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" context="text/html; charset=UTF-8">
    <title>Please Log In</title>
    <link rel="stylesheet" th:href="@{css/stylesheet.css}">
</head>
<body>
<script type="text/javascript" >
    // Copied this code from:
    // https://stackoverflow.com/questions/56000575/spring-security-disable-login-page-while-session-is-valid
    // This is to prevent the user pressing the back button in browser to go back to the login page
    // once they are logged in.
    function preventBack() {
        window.history.forward();
    }
    setTimeout("preventBack()", 0);
    window.onunload= function() { null };
</script>
<div id="form">
    <h1>Please Log In</h1>
<form id="loginForm" method="post" th:action="@{/login}">
    <input type="hidden"
           th:name="${_csrf.parameterName}"
           th:value="${_csrf.token}" />
    <div th:if="${param.logout}">
        <p>You have been logged out.</p>
    </div>
    <div>
        <input name="username" placeholder="Username" type="text"/>
        <input name="password" placeholder="Password" type="password"/>
        <p class="errorMessage" th:if="${param.error}" data-th-text="${session.SPRING_SECURITY_LAST_EXCEPTION.message}"></p>
    </div>
    <div style="display: flex; flex-direction: column">
        <input type="submit" value="Sign in"/>
        <a th:href="@{register}" style="margin-top: 20px">Not Registered? Create an account</a>
    </div>

</form>
</div>
<script type="text/javascript">
    document.getElementById("loginForm").addEventListener("keydown", function(event) {
        if (event.key === "Enter") {
            var activeElement = document.activeElement;
            if (activeElement.type === "submit") {
                return true;
            } else {
                event.preventDefault();
            }
        }
    });
</script>
</body>
</html>